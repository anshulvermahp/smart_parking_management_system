<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Parking.com - Smart Parking Solutions</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Modern Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
    rel="stylesheet">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

  <style>
    :root {
      --primary: #000000;
      /* Black for neutral strong actions */
      --secondary: #555555;
      /* Dark Gray */
      --accent: #e5e5e5;
      /* Light Gray for borders/bgs */
      --bg-body: #ffffff;
      /* White */
      --bg-surface: #f8f9fa;
      /* Very light gray for cards/hero */
      --text-main: #1a1a1a;
      --text-muted: #666666;
      --glass-bg: rgba(255, 255, 255, 0.9);
      --glass-border: rgba(0, 0, 0, 0.05);
    }

    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
      margin: 0;
      padding: 0;
      background: var(--bg-body);
      color: var(--text-main);
      overflow-x: hidden;
    }

    /* Modern Hero Section - Neutral Light */
    .hero-section {
      position: relative;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      background: var(--bg-surface);
      background-image: radial-gradient(circle at 50% 0%, #f0f0f0 0%, #ffffff 70%);
      overflow-x: hidden;
      z-index: 1;
      justify-content: space-between;
      padding-bottom: 2rem;
    }

    /* Navbar */
    .navbar {
      padding: 1.5rem 0;
      transition: all 0.3s ease;
    }

    .navbar.scrolled {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
      padding: 0.8rem 0;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
    }

    .navbar-brand {
      font-weight: 800;
      font-size: 1.5rem;
      letter-spacing: -0.5px;
      color: var(--primary) !important;
    }

    .navbar-brand i {
      color: var(--primary) !important;
    }

    .nav-btn {
      transition: all 0.3s ease;
      font-weight: 600;
      color: var(--text-main) !important;
    }

    .nav-btn:hover {
      transform: translateY(-2px);
      color: var(--primary) !important;
    }

    .btn-signup-nav {
      background: var(--primary);
      color: white !important;
      border: none;
    }

    .btn-signup-nav:hover {
      background: #333;
      transform: translateY(-2px);
    }

    /* Hero Content */
    .hero-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 2rem;
      z-index: 2;
    }

    .hero-title {
      color: var(--text-main);
      font-weight: 800;
      font-size: 4rem;
      line-height: 1.1;
      margin-bottom: 1.5rem;
      letter-spacing: -1.5px;
      animation: fadeInUp 0.8s ease-out 0.2s backwards;
    }

    .hero-title span {
      color: #777;
      /* Neutral gray span */
    }

    .hero-subtitle {
      color: var(--text-muted);
      font-size: 1.25rem;
      margin-bottom: 3rem;
      max-width: 600px;
      line-height: 1.6;
      animation: fadeInUp 0.8s ease-out 0.4s backwards;
    }

    /* Search Card - Light Neutral */
    .search-card {
      background: #ffffff;
      padding: 0.75rem;
      border-radius: 20px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.08);
      width: 100%;
      max-width: 650px;
      display: flex;
      gap: 12px;
      border: 1px solid rgba(0, 0, 0, 0.05);
      animation: fadeInUp 0.8s ease-out 0.6s backwards;
      position: relative;
    }

    .search-input-wrapper {
      position: relative;
      flex-grow: 1;
      display: flex;
      align-items: center;
    }

    .search-input {
      border: 1px solid #e0e0e0;
      padding: 16px 24px;
      padding-right: 50px;
      font-size: 1.1rem;
      width: 100%;
      border-radius: 14px;
      background: #f8f9fa;
      color: var(--text-main);
      font-weight: 500;
      transition: all 0.3s;
    }

    .search-input:focus {
      outline: none;
      background: #ffffff;
      border-color: #000;
      box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.05);
    }

    .search-input::placeholder {
      color: #999;
    }

    .btn-gps {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      border: 1px solid #e0e0e0;
      background: #ffffff;
      color: var(--text-main);
      width: 36px;
      height: 36px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s;
      z-index: 10;
    }

    .btn-gps:hover {
      background: #f0f0f0;
      border-color: #ccc;
    }

    .btn-search {
      background: var(--primary);
      color: white;
      border-radius: 14px;
      padding: 0 40px;
      font-weight: 700;
      font-size: 1.1rem;
      border: none;
      transition: all 0.3s;
      white-space: nowrap;
    }

    .btn-search:hover {
      background: #333;
      transform: translateY(-2px);
      box-shadow: 0 10px 20px -5px rgba(0, 0, 0, 0.2);
    }

    /* Nearest Parking Section */
    .section-header {
      margin-bottom: 2.5rem;
    }

    .section-title {
      font-weight: 800;
      font-size: 2rem;
      margin-bottom: 0.5rem;
      color: var(--text-main);
    }

    #location-status {
      color: var(--text-muted) !important;
    }

    .parking-card {
      background: #ffffff;
      border-radius: 24px;
      overflow: hidden;
      border: 1px solid #eee;
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      height: 100%;
      text-decoration: none;
      color: inherit;
      display: block;
      position: relative;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.03);
    }

    .parking-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.1);
      border-color: #e0e0e0;
    }

    .parking-img-wrapper {
      position: relative;
      height: 220px;
      overflow: hidden;
      /* removed grayscale filter */
    }

    .parking-card:hover .parking-img-wrapper {
      /* filter: grayscale(0%); */
    }

    .parking-img {
      height: 100%;
      width: 100%;
      object-fit: cover;
      transition: transform 0.6s ease;
    }

    .parking-card:hover .parking-img {
      transform: scale(1.1);
    }

    .price-tag {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: #ffffff;
      color: #000000;
      font-weight: 800;
      padding: 8px 16px;
      border-radius: 50px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      z-index: 2;
    }

    .status-badge {
      position: absolute;
      bottom: 1rem;
      left: 1rem;
      background: #000000;
      border: 1px solid #ffffff;
      color: #ffffff;
      padding: 4px 12px;
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 700;
    }

    .parking-body {
      padding: 1.5rem;
    }

    .parking-body h5 {
      color: var(--text-main) !important;
      font-weight: 700;
    }

    .location-text {
      font-size: 0.95rem;
      color: var(--text-muted);
      margin-bottom: 1rem;
      display: block;
    }

    .book-btn-fake {
      display: inline-block;
      width: 100%;
      text-align: center;
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      color: var(--text-main);
      padding: 12px;
      border-radius: 12px;
      font-weight: 700;
      margin-top: 0.5rem;
      transition: 0.2s;
    }

    .parking-card:hover .book-btn-fake {
      background: #000000;
      color: #ffffff;
      border-color: #000000;
    }

    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {

      0%,
      100% {
        opacity: 0.5;
      }

      50% {
        opacity: 0.8;
      }
    }

    /* Responsive */
    @media (max-width: 991px) {
      .hero-title {
        font-size: 2.8rem;
      }

      .search-card {
        flex-direction: column;
        padding: 1rem;
      }

      .search-input {
        padding-right: 50px;
        text-align: left;
      }

      .search-input-wrapper {
        width: 100%;
      }

      .btn-gps {
        right: 10px;
      }

      .btn-search {
        width: 100%;
        padding: 14px 0;
      }

      .navbar-collapse {
        background: #ffffff;
        /* White background for mobile menu */
        border: 1px solid #eee;
        border-radius: 20px;
        padding: 1.5rem;
        margin-top: 1rem;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
      }

      .nav-link,
      .btn-link {
        color: var(--text-main) !important;
      }

      .navbar-toggler {
        border: none;
        padding: 0;
      }

      .navbar-toggler:focus {
        box-shadow: none;
      }

      .hero-content {
        padding: 1rem;
        padding-top: 120px;
        /* Spacer for fixed navbar */
        justify-content: flex-start;
        /* Stop centering vertically on mobile */
      }
    }


    /* Autocomplete */
    .suggestions-list {
      position: absolute;
      top: calc(100% + 10px);
      left: 0;
      right: 0;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      overflow: hidden;
      z-index: 1000;
      display: none;
      border: 1px solid #eee;
      max-height: 250px;
      overflow-y: auto;
    }

    .suggestion-item {
      padding: 12px 20px;
      cursor: pointer;
      transition: 0.2s;
      border-bottom: 1px solid #f0f0f0;
      text-align: left;
      background: none;
      width: 100%;
      border: none;
      color: #333;
      font-weight: 500;
      display: flex;
      align-items: center;
    }

    .suggestion-item:hover {
      background: #f8f9fa;
      color: #000;
    }
  </style>
</head>

<body>

  <div class="hero-section">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg px-4 fixed-top">
      <div class="container-fluid max-w-7xl">
        <a class="navbar-brand d-flex align-items-center gap-2" href="#">
          <i class="bi bi-p-square-fill" style="font-size: 1.8rem;"></i>
          <span>Parking.com</span>
        </a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <i class="bi bi-list fs-1 text-dark"></i>
        </button>

        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
          <div class="d-flex flex-column flex-lg-row align-items-center gap-3">
            <% if (typeof user !=='undefined' && user) { %>
              <a href="/viewBooking" class="btn btn-link text-decoration-none fw-semibold nav-btn">My Bookings</a>
              <a href="/profile" class="btn btn-light rounded-pill px-4 nav-btn fw-bold border">
                <i class="bi bi-person-fill me-1"></i> Profile
              </a>

              <% if ((user.roles && user.roles.includes('owner')) || user.owner) { %>
                <a href="/owner/dashboard" class="btn btn-outline-dark rounded-pill px-4 fw-bold nav-btn">
                  Owner Dashboard
                </a>
                <a href="/owners/profile" class="btn btn-outline-dark rounded-pill px-4 fw-bold nav-btn">
                  Owner Profile
                </a>
              <% } else { %>
                <a href="/owners/owner_registration" class="btn btn-outline-dark rounded-pill px-4 fw-bold nav-btn">
                  Become a Host
                </a>
              <% } %>

                    <% } else { %>
                      <a href="/login" class="btn btn-link text-decoration-none fw-semibold nav-btn">Log in</a>
                      <a href="/register" class="btn btn-signup-nav rounded-pill px-4 fw-bold nav-btn shadow-sm">Sign
                        up</a>
                      <a href="/owners/owner_registration"
                        class="btn btn-outline-dark rounded-pill px-4 fw-bold nav-btn">List Parking</a>
                      <% } %>
          </div>
        </div>
      </div>
    </nav>

    <div class="hero-content container mt-5 pt-5"> ">
      <h1 class="hero-title">
        Parking made <br><span>effortless.</span>
      </h1>
      <p class="hero-subtitle">
        Discover unmatched convenience. Find, book, and park at thousands of secure locations instantly using our smart
        network.
      </p>

      <form class="search-card" action="/map" method="GET">
        <div class="search-input-wrapper" id="areaInputParent">
          <i class="bi bi-search position-absolute ms-3 text-muted" style="left: 0;"></i>
          <input type="text" class="search-input" id="areaInput" name="area" placeholder="Where do you want to park?"
            style="padding-left: 48px;" autocomplete="off" required>

          <button type="button" id="gpsBtn" class="btn-gps" title="Use current location">
            <i class="bi bi-geo-alt-fill"></i>
          </button>

          <div class="suggestions-list" id="suggestionBox"></div>
        </div>
        <button type="submit" class="btn-search">Search Now</button>
      </form>
    </div>

    <!-- Nearest Parking Section Inside Hero -->
    <div class="container pb-4">
      <div class="d-flex justify-content-between align-items-end mb-4">
        <div>
          <h3 class="section-title fs-4">Parking Near You</h3>
          <p class="text-muted mb-0" id="location-status"><i class="bi bi-broadcast me-1"></i> Detecting your
            location...
          </p>
        </div>
        <a href="/map" class="btn btn-outline-dark rounded-pill px-4 fw-bold border-2">Explore Map <i
            class="bi bi-arrow-right ms-2"></i></a>
      </div>

      <div class="row g-4" id="nearest-parking-container">
        <!-- Loading Skeletons -->
        <% for(let i=0; i<3; i++) { %>
          <div class="col-lg-4 col-md-6">
            <div class="card border-0 shadow-sm h-100 rounded-4 overflow-hidden"
              style="background: #fff; border: 1px solid #eee;">
              <div class="" style="height: 220px; background: #f0f0f0; animation: pulse 1.5s infinite;"></div>
              <div class="p-4">
                <div class="mb-3"
                  style="height: 24px; width: 70%; border-radius: 6px; background: #f0f0f0; animation: pulse 1.5s infinite;">
                </div>
                <div class="mb-3"
                  style="height: 16px; width: 40%; border-radius: 6px; background: #f0f0f0; animation: pulse 1.5s infinite;">
                </div>
                <div class="mt-4"
                  style="height: 40px; width: 100%; border-radius: 12px; background: #f0f0f0; animation: pulse 1.5s infinite;">
                </div>
              </div>
            </div>
          </div>
          <% } %>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Navbar Scroll Effect
    const nav = document.querySelector('.navbar');

    function updateNavbar() {
      if (window.scrollY > 50) {
        nav.classList.add('scrolled');
      } else {
        nav.classList.remove('scrolled');
      }
    }

    window.addEventListener('scroll', updateNavbar);
    updateNavbar(); // Init

    // --- Search Autocomplete ---
    const areaInput = document.getElementById('areaInput');
    const suggestionBox = document.getElementById('suggestionBox');
    let debounceTimer;

    areaInput.addEventListener('input', function () {
      clearTimeout(debounceTimer);
      const query = this.value.trim();

      if (query.length < 2) {
        suggestionBox.style.display = 'none';
        return;
      }

      debounceTimer = setTimeout(() => {
        fetch(`https://photon.komoot.io/api/?q=${encodeURIComponent(query)}&limit=5`)
          .then(r => r.json())
          .then(data => {
            suggestionBox.innerHTML = '';
            if (data.features && data.features.length) {
              data.features.forEach(f => {
                const p = f.properties;
                const label = [p.name, p.street, p.city].filter(Boolean).join(', ');
                const btn = document.createElement('button');
                btn.className = 'suggestion-item';
                btn.type = 'button';
                btn.innerHTML = `<i class="bi bi-geo-alt me-2 text-muted"></i> ${label}`;
                btn.onclick = () => {
                  areaInput.value = label;
                  suggestionBox.style.display = 'none';
                };
                suggestionBox.appendChild(btn);
              });
              suggestionBox.style.display = 'block';
            } else {
              suggestionBox.style.display = 'none';
            }
          })
          .catch(e => console.error(e));
      }, 300);
    });

    // Close suggestions on click outside
    document.addEventListener('click', (e) => {
      if (!document.getElementById('areaInputParent').contains(e.target)) {
        suggestionBox.style.display = 'none';
      }
    });

    // --- GPS Location Button Fix ---
    const gpsBtn = document.getElementById('gpsBtn');
    const locationStatus = document.getElementById('location-status');

    // Helper to get IP Location
    async function getIpLocation() {
      try {
        const r = await fetch('https://ipapi.co/json/');
        const d = await r.json();
        if (d.latitude && d.longitude) return d;
        throw new Error('IP Location Failed');
      } catch (e) {
        console.warn(e);
        return null;
      }
    }

    gpsBtn.addEventListener('click', () => {
      // Visual feedback
      const originalIcon = gpsBtn.innerHTML;
      gpsBtn.innerHTML = '<span class="spinner-border spinner-border-sm text-primary" role="status"></span>';
      gpsBtn.disabled = true;

      // Browser Security Check (Mobile HTTP issue)
      const isSecure = window.isSecureContext;

      const onLocationSuccess = (pos) => {
        const { latitude, longitude } = pos.coords;
        fetchAddress(latitude, longitude);
      };

      const onLocationError = async (err) => {
        console.warn("Geolocation denied/failed:", err);

        // Check permission state when available for clearer messaging
        let permState = null;
        try {
          if (navigator.permissions && navigator.permissions.query) {
            const st = await navigator.permissions.query({ name: 'geolocation' });
            permState = st.state; // 'granted' | 'prompt' | 'denied'
          }
        } catch (e) {
          // ignore
        }

        // Try IP Fallback
        const ipLoc = await getIpLocation();

        if (ipLoc) {
          areaInput.value = `${ipLoc.city || ''}${ipLoc.region ? ', ' + ipLoc.region : ''}`.trim();
          gpsBtn.innerHTML = originalIcon;
          gpsBtn.disabled = false;
          const reason = (!isSecure && window.location.hostname !== 'localhost') ? 'browser blocked GPS on non-HTTPS' : (permState === 'denied' ? 'permission denied' : 'network/unavailable');
          alert(`GPS unavailable (${reason}). Using approximate location: ${ipLoc.city || ipLoc.region || 'unknown'}.`);
          return;
        }

        let msg = 'Could not get location.';
        if (!isSecure && window.location.hostname !== 'localhost') {
          msg += ' (Browser blocks GPS on non-HTTPS. Use HTTPS or localhost.)';
        } else if (permState === 'denied' || err.code === 1) {
          msg = 'Location access denied. Please enable location permission in your browser or type manually.';
        }
        alert(msg);

        gpsBtn.innerHTML = originalIcon;
        gpsBtn.disabled = false;
      };

      if (!navigator.geolocation) {
        onLocationError({ code: 0, message: "Not supported" });
        return;
      }

      navigator.geolocation.getCurrentPosition(onLocationSuccess, onLocationError, { timeout: 15000, enableHighAccuracy: true });

      function fetchAddress(lat, lon) {
        // Nominatim for better street-level details
        fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}`, {
          headers: { 'User-Agent': 'SmartParkingApp/1.0' }
        })
          .then(r => r.json())
          .then(d => {
            if (d.address) {
              const a = d.address;
              const fields = [
                a.house_number,
                a.road,
                a.pedestrian,
                a.cycleway,
                a.residential,
                a.neighbourhood,
                a.suburb,
                a.village,
                a.town,
                a.city,
                a.county,
                a.state_district,
                a.state
              ];

              // Normalize and preserve order, removing exact duplicates (case-insensitive)
              let parts = fields
                .filter(Boolean)
                .map(p => String(p).trim())
                .filter(p => p.length > 0);

              const seen = new Set();
              parts = parts.filter(p => {
                const key = p.toLowerCase();
                if (seen.has(key)) return false;
                seen.add(key);
                return true;
              });

              // If still empty, try to use display_name but dedupe its comma parts
              if (parts.length === 0 && d.display_name) {
                parts = d.display_name.split(',').map(s => s.trim()).filter(Boolean);
                const seen2 = new Set();
                parts = parts.filter(p => {
                  const key = p.toLowerCase();
                  if (seen2.has(key)) return false;
                  seen2.add(key);
                  return true;
                });
              }

              // Limit length to avoid overly long values in the input
              let addr = parts.join(', ');
              if (!addr && d.display_name) addr = d.display_name;
              if (!addr) addr = `${lat.toFixed(5)}, ${lon.toFixed(5)}`;
              if (addr.length > 120) addr = addr.slice(0, 120).trim().replace(/[,\s]+$/,'') + '...';

              areaInput.value = addr;
            } else {
              areaInput.value = `${lat.toFixed(5)}, ${lon.toFixed(5)}`;
            }
          })
          .catch(err => {
            console.error('Reverse Geocoding Error:', err);
            areaInput.value = `${lat.toFixed(5)}, ${lon.toFixed(5)}`;
          })
          .finally(() => {
            gpsBtn.innerHTML = originalIcon;
            gpsBtn.disabled = false;
          });
      }
    });


    // --- Load Nearest Parking ---
    const container = document.getElementById('nearest-parking-container');

    function loadNearest() {
      if (!navigator.geolocation) {
        fallbackToDefault();
        return;
      }

      navigator.geolocation.getCurrentPosition(
        (pos) => {
          locationStatus.innerHTML = '<i class="bi bi-geo-alt-fill text-primary"></i> Spots near you';
          fetchSpots(pos.coords.latitude, pos.coords.longitude);
        },
        (err) => {
          console.warn("Auto-location failed:", err);

          // Try IP location for nearest spots
          fetch('https://ipapi.co/json/')
            .then(r => r.json())
            .then(data => {
              if (data.latitude && data.longitude) {
                locationStatus.innerHTML = `<i class="bi bi-geo-alt text-secondary"></i> Spots near ${data.city} (Approx)`;
                fetchSpots(data.latitude, data.longitude);
              } else {
                fallbackToDefault();
              }
            })
            .catch(() => fallbackToDefault());
        },
        { timeout: 5000 }
      );
    }

    function fallbackToDefault() {
      locationStatus.innerHTML = '<i class="bi bi-info-circle text-secondary"></i> Showing spots in Chandigarh (Default)';
      fetchSpots(30.7333, 76.7794);
    }

    function fetchSpots(lat, lon) {
      fetch(`/parking?lat=${lat}&lon=${lon}`)
        .then(r => r.json())
        .then(data => {
          const limit = data.slice(0, 3); // Top 3
          if (limit.length === 0) {
            container.innerHTML = '<div class="col-12 text-center text-muted py-4">No parking spots found nearby.</div>';
            return;
          }

          container.innerHTML = limit.map(p => `
                    <div class="col-lg-4 col-md-6">
                        <a href="/book?parkingId=${p._id}" class="parking-card border-0 shadow-sm">
                            <div class="parking-img-wrapper">
                                <span class="price-tag">â‚¹${p.pricing.hourly}/hr</span>
                                <span class="status-badge"><i class="bi bi-check-circle-fill me-1"></i>${p.availableSlots} Open</span>
                                <img src="${(p.images && p.images.length) ? p.images[0] : 'https://images.unsplash.com/photo-1506521781263-d8422e82f27a?auto=format&fit=crop&q=80&w=800'}" 
                                     class="parking-img" alt="${p.name}">
                            </div>
                            <div class="parking-body">
                                <h5 class="fw-bold mb-1 text-truncate">${p.name}</h5>
                                <span class="location-text text-truncate">
                                    <i class="bi bi-geo-alt me-1 text-secondary"></i> ${p.address.street || ''}, ${p.address.city || ''}
                                </span>
                                <div class="book-btn-fake">
                                    Book Spot
                                </div>
                            </div>
                        </a>
                    </div>
                `).join('');
        })
        .catch(e => {
          console.error(e);
          container.innerHTML = '<div class="col-12 text-center text-danger">Error loading parking spots.</div>';
        });
    }

    // Init
    loadNearest();

  </script>
</body>

</html>